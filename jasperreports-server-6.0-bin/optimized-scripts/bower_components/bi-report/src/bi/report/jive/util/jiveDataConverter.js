define(["require","jquery","common/util/parse/number","common/util/parse/date","common/util/parse/time","common/jquery/extension/timepickerExt"],function(e){var t=e("jquery"),r=e("common/util/parse/number"),i=e("common/util/parse/date"),a=e("common/util/parse/time");e("common/jquery/extension/timepickerExt");var n={jQueryUiTimestampToIsoTimestamp:function(e,r){if(r&&r.calendarPatterns){var a=r.calendarPatterns.date,n=r.calendarPatterns.time;return i.dateObjectToIso8601Timestamp(t.datepicker.parseDateTime(a,n,e))}return void 0},jQueryUiTimeToIsoTime:function(e,r){if(r&&r.calendarPatterns){var i=r.calendarPatterns.time,n=t.datepicker.parseTime(i,e);if(n)return a.timeToIso8061Time(n.hour,n.minute,n.second)}return void 0},isoTimestampTojQueryUiTimestamp:function(e,r){if(r&&r.calendarPatterns){var a=i.iso8601TimestampToDateObject(e),n=r.calendarPatterns.date,o=r.calendarPatterns.time,m=t.timepicker&&t.timepicker._defaults&&t.timepicker._defaults.separator?t.timepicker._defaults.separator:" ",_=t.datepicker.formatDate(n,a),T=t.datepicker.formatTime(o,{hour:a.getHours(),minute:a.getMinutes(),second:a.getSeconds()});return _+m+T}return void 0},isoTimeTojQueryUiTime:function(e,r){if(r&&r.calendarPatterns){var i=a.iso8601TimeToTimeObject(e),n=r.calendarPatterns.time;if(i)return t.datepicker.formatTime(n,{hour:i.hours,minute:i.minutes,second:i.seconds})}return void 0},filterStartValue:function(e,t,i,a){var o=null==t&&null==e,m="boolean"===i,T="numeric"===i,u="datetime"===i,s="time"===i;return o?"":_.isArray(t)?u?n.isoTimestampTojQueryUiTimestamp(t[0],a):s?n.isoTimeTojQueryUiTime(t[0],a):T?r.formatNumber(t[0]):t[0]:m?"":u?n.isoTimestampTojQueryUiTimestamp(t,a):s?n.isoTimeTojQueryUiTime(t,a):T?r.formatNumber(t):t},filterEndValue:function(e,t,i,a){var o=null==t&&null==e,m="numeric"===i,T="datetime"===i,u="time"===i;return o?"":_.isArray(t)?T?n.isoTimestampTojQueryUiTimestamp(t[1],a):u?n.isoTimeTojQueryUiTime(t[1],a):m?r.formatNumber(t[1]):t[1]:""},dataTypeToSchemaFormat:{Text:"string",Numeric:"numeric",Date:"datetime",Boolean:"boolean",Time:"time"},schemaFormatOperatorToFilterOperatorMap:function(){var e={};return e.string={},e.string.equal="EQUALS",e.string.not_equal="IS_NOT_EQUAL_TO",e.string.contain="CONTAINS",e.string.not_contain="DOES_NOT_CONTAIN",e.string.start_with="STARTS_WITH",e.string.not_start_with="DOES_NOT_START_WITH",e.string.end_with="ENDS_WITH",e.string.not_end_with="DOES_NOT_END_WITH",e.datetime={},e.datetime.equal="EQUALS",e.datetime.not_equal="IS_NOT_EQUAL_TO",e.datetime.between="IS_BETWEEN",e.datetime.not_between="IS_NOT_BETWEEN",e.datetime.on_or_before="IS_ON_OR_BEFORE",e.datetime.before="IS_BEFORE",e.datetime.on_or_after="IS_ON_OR_AFTER",e.datetime.after="IS_AFTER",e.time={},e.time.equal="EQUALS",e.time.not_equal="IS_NOT_EQUAL_TO",e.time.between="IS_BETWEEN",e.time.not_between="IS_NOT_BETWEEN",e.time.on_or_before="IS_ON_OR_BEFORE",e.time.before="IS_BEFORE",e.time.on_or_after="IS_ON_OR_AFTER",e.time.after="IS_AFTER",e.numeric={},e.numeric.equal="EQUALS",e.numeric.not_equal="DOES_NOT_EQUAL",e.numeric.greater="GREATER_THAN",e.numeric.greater_or_equal="GREATER_THAN_EQUAL_TO",e.numeric.less="LESS_THAN",e.numeric.less_or_equal="LESS_THAN_EQUAL_TO",e.numeric.between="IS_BETWEEN",e.numeric.not_between="IS_NOT_BETWEEN",e}(),filterOperatorToSchemaFormatMap:function(){var e={};return e.string={},e.string.EQUALS="equal",e.string.IS_NOT_EQUAL_TO="not_equal",e.string.CONTAINS="contain",e.string.DOES_NOT_CONTAIN="not_contain",e.string.STARTS_WITH="start_with",e.string.DOES_NOT_START_WITH="not_start_with",e.string.ENDS_WITH="end_with",e.string.DOES_NOT_END_WITH="not_end_with",e.datetime={},e.datetime.EQUALS="equal",e.datetime.IS_NOT_EQUAL_TO="not_equal",e.datetime.IS_BETWEEN="between",e.datetime.IS_NOT_BETWEEN="not_between",e.datetime.IS_ON_OR_BEFORE="on_or_before",e.datetime.IS_BEFORE="before",e.datetime.IS_ON_OR_AFTER="on_or_after",e.datetime.IS_AFTER="after",e.numeric={},e.numeric.EQUALS="equal",e.numeric.DOES_NOT_EQUAL="not_equal",e.numeric.GREATER_THAN="greater",e.numeric.GREATER_THAN_EQUAL_TO="greater_or_equal",e.numeric.LESS_THAN="less",e.numeric.LESS_THAN_EQUAL_TO="less_or_equal",e.numeric.IS_BETWEEN="between",e.numeric.IS_NOT_BETWEEN="not_between",e.time={},e.time.EQUALS="equal",e.time.IS_NOT_EQUAL_TO="not_equal",e.time.IS_BETWEEN="between",e.time.IS_NOT_BETWEEN="not_between",e.time.IS_ON_OR_BEFORE="on_or_before",e.time.IS_BEFORE="before",e.time.IS_ON_OR_AFTER="on_or_after",e.time.IS_AFTER="after",e}(),schemaFormatOperatorToFilterOperator:function(e,t,r){return"boolean"!==r?n.schemaFormatOperatorToFilterOperatorMap[r][e]:"equal"===e&&t===!0?"IS_TRUE":"equal"===e&&t===!1?"IS_FALSE":"not_equal"===e&&t===!0?"IS_NOT_TRUE":"not_equal"===e&&t===!1?"IS_NOT_FALSE":void 0},operatorAndValueToSchemaFormat:function(e,t,i,a){var o={};if("boolean"===t)"IS_TRUE"===e?(o.operator="equal",o.value=!0):"IS_FALSE"===e?(o.operator="equal",o.value=!1):"IS_NOT_TRUE"===e?(o.operator="not_equal",o.value=!0):"IS_NOT_FALSE"===e&&(o.operator="not_equal",o.value=!1);else if(o.operator=n.filterOperatorToSchemaFormatMap[t][e],"string"===t)o.value=i;else if("numeric"===t)try{o.value="between"===o.operator||"not_between"===o.operator?[r.parseNumber(i),r.parseNumber(a)]:r.parseNumber(i)}catch(m){throw new Error("Cannot convert filter value to number",m)}else"datetime"===t?o.value="between"===o.operator||"not_between"===o.operator?[n.jQueryUiTimestampToIsoTimestamp(i,this.parent&&this.parent.config?this.parent.config.genericProperties:void 0),n.jQueryUiTimestampToIsoTimestamp(a,this.parent&&this.parent.config?this.parent.config.genericProperties:void 0)]:n.jQueryUiTimestampToIsoTimestamp(i,this.parent&&this.parent.config?this.parent.config.genericProperties:void 0):"time"===t&&(o.value="between"===o.operator||"not_between"===o.operator?[n.jQueryUiTimeToIsoTime(i,this.parent&&this.parent.config?this.parent.config.genericProperties:void 0),n.jQueryUiTimeToIsoTime(a,this.parent&&this.parent.config?this.parent.config.genericProperties:void 0)]:n.jQueryUiTimeToIsoTime(i,this.parent&&this.parent.config?this.parent.config.genericProperties:void 0));return o}};return n});